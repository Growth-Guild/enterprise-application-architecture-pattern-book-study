# Chapter 09. 도메인 논리 패턴
- - -

## 트랜잭션 스크립트
* 비즈니스 논리를 프로시저별로 구성해 각 프로시저가 프레젠테이션의 단일 요청을 처리하게 한다.

### 작동 원리
* 트랜잭션 스크립트를 사용하는 경우 도메인 논리는 주로 시스템에 대해 수행하는 트랜잭션으로 구성된다.
* 이 방식의 장점 중 하나는 다른 트랜잭션에서 하는 일에 대해 신경 쓸 필요가 없다는 것이다.
  * 입력을 받고, 데이터베이스에서 정보를 얻고, 필요한 작업을 한 후, 결과를 데이터베이스에 저장하면 된다.
* 트랜잭션 스크립트는 최대한 분리하는 것이 좋다.
  * 적어도 별도의 서브루틴에 넣어야 하며, 프레젠테이션과 데이터 원본을 처리하는 클래스와는 다른 클래스에 넣는 것이 좋다.
  * 트랜잭션 스크립트에는 프레젠테이션 논리에 대한 호출을 전혀 포함하지 말아야 한다.

### 사용 시점
* 트랜잭션 스크립트의 가장 큰 장점은 단순함이다.
* 작은 규모의 논리가 포함된 애플리케이션에서 자연스럽게 논리를 구성할 수 있는 방법이며, 코드를 실행할 때 발생하는 오버헤드가 적고 코드를 이해하기 쉽다.
* 하지만 비즈니스가 논리가 복잡해지면 좋은 설계 상태를 유지하기가 점차 어려워지고, 트랜잭션 간의 코드 중복이 발생한다.
  * 규칙이 복잡해지면 해결하는 방벙블 찾기 어렵다.
  * 복잡한 비즈니스 도메인을 구현할 때는 도메인 모델을 이용하는 것이 좋다.

## 도메인 모델
* 도메인 모델은 규칙과 논리는 매우 다양한 사례와 동작의 변형을 나타내며, 객체는 이러한 복잡성을 처리하기 위해 고안됐다.
* 도메인 모델은 의미있는 하나의 대상을 나타내는 상호 연결된 객체의 연결망으로 이뤄진다.

### 작동 원리
* 애플리케이션에서 도메인 모델을 구현하는 과정은 비즈니스 영역을 모델링하는 객체로 구성된 계층을 구성하는 과정이다.
* 객체 중에는 일상적인 업무에 사용되는 비즈니스 데이터를 나타내는 객체도 있고 비즈니스 규칙을 나타내는 객체도 있다.
* 단순 도메인 모델은 대부분의 도메인 객체가 각 데이터베이스 테이블과 일치하므로 외형상 데이터베이스 설계와 거의 비슷해 보인다.
* 리치 도메인 모델은 상속, 전략, 다양한 패턴, 그리고 복잡한 상호 연결된 객체의 연결망을 포함하므로 데이터베이스 설계와는 상당히 다르게 보일 수 있다.
  * 리치 도메인 모델은 복잡한 논리를 나타내는 데 적합하지만 데이터베이스에 매핑하기는 더 어렵다.
* 도메인 모델은 시스템의 다른 계창 간의 결합을 최소화해야 한다.

### 자바 구현
* POJO 도메인 모델은 이해하기 쉽고, 빠르게 만들 수 있으며, EJB 컨테이너 외부에서 실행 및 테스트할 수 있고, EJB에 대해 독립적이다.
* 상속, 전략, 그밖의 다른 정교한 패턴 등이 포함된 복잡한 도메인 논리를 구축하려면 상업용 툴이나 직접 제작한 계층을 활용해 POJO 도메인 모델과 데이터 매퍼를 만드는 것이 좋다.

### 사용 시점
* 복잡하고 끊임없이 변하는 비즈니스 규칙을 구현해야 한다면 객체 모델을 사용해 비즈니스 규칙을 처리하는 것이 현명하다.
* 간단한 null 검사, 간단한 합계 계산 등이 전부라면 트랜잭션 스크립트가 더 나은 선택이다.
