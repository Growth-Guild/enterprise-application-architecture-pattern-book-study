# Chapter 01. 계층화
- - -

## 계층형 아키텍처
* 상위 계층은 하위 계층이 정의하는 다양한 서비스를 이용하지만, 하위 계층은 상위 계층을 인식하지 못한다.
* 모든 계층형 아키텍쳐가 불투명한 구조를 갖는 것은 아니지만 대부분이 그러하다.

## 시스템을 계층으로 분할할 때의 장점
* 다른 계층에 대한 정보 없이도 단을 계층을 하나의 일관된 계층으로 이해할 수 있다.
* 동일한 기본 서비스를 가진 대안 구현으로 계층을 대체할 수 있다.
* 계층 간의 의존성을 최소화할 수 있다.
* 한 번 구축한 계층은 여러 다른 상위 서비스에서 사용할 수 있다.

## 시스템을 계층으로 분할할 때의 단점
* 계층은 전체가 효과적으로 캡슐화되지 않는다.
  * 변경이 발생했을 때 다른 계층에 영향을 미치는 경우가 있다.
  * 계층형 엔터프라이즈 애플리케이션에서 볼 수 있는 전형적인 예는 UI에 표시해아 하는 필드가 데이터 베이스에도 있어야 하므로 그 사이에 있는 모든 계층에 해당 필드를 추가해야 한다.
* 계층을 추가하면 성능이 저하된다.
  * 일반적으로 각 계층에서는 정보를 한 표현에서 다른 표현으로 변환해야 하기 때문이다.
  * 하지만 기반 기능을 캡슐화하면 성능 저하가 보상될 만큼 효율이 향상되는 경우도 많다.

```text
계층형 아키텍처에서 가장 어려운 부분은 어떤 계층을 만들고 각 계층이 어떤 역할을 담당할지 결정하는 것
```

## 세 가지 주요 계층
* 프레젠테이션 - Presentation
  * 사용자와 소프트웨어 간 상호작용을 처리한다.
  * 프레젠테이션 계층의 주 역할은 사용자에게 정보를 표시하고 사용자가 내린 명령을 도메인과 데이터 원본에서 수행할 작업으로 해석하는 것이다.
* 도메인 원본 - Data source
  * 데이터 원본의 논리는 애플리케이션을 대신해 다른 시스템과 통신한다. (트랜잭션 모니터, 다른 애플리케이션, 메시징 시스템 등..)
  * 대부분의 엔터프라이즈 애플리케이션에서 가장 큰 데이터 원본 논리는 지속성 데이터를 저장하는 데이터베이스다.
* 도메인 논리 - Domain logic
  * 애플리케이션이 수행해야 하는 도메인과 관련된 작업이다.
  * 입력과 저장된 데이터를 바탕으로 하는 계산, 프레젠테이션에서 받은 데이터의 유효성 검사, 프레젠테이션에서 받은 명령을 기준으로 작업 대상이 될 데이터 원본 논리를 결정하는 등의 작업이 포함된다.

### 프레젠테이션과 데이터 원본
* 프레젠테이션은 복잡한 사용자 인터페이스 또는 간단한 원격 프로그램 인터페이스이든 관계없이 시스템이 다른 사람에게 제공하는 서비스에 대한 외부 인터페이스다.
* 데이터 원본은 프로그램에 제공하는 서비스에 대한 외부 인터페이스다.

### 의존성의 중요성
* 도메인과 데이터 원본은 프레젠테이션에 의존하지 않아야 한다.
  * 위 규칙은 동일한 기반을 유지하면서 다른 프레젠테이션으로 교체하기 용이하다.

## 계층이 실행될 위치 선택
* 계층 간의 분리는 모든 계층이 한 시스템에서 실행되더라도 유용하며, 계층이 실행될 위치를 선택하는 것이 중요하다.
