# Chapter 12. 객체-관계형 구조 패턴

## 식별자 필드
* 인메모리 객체와 데이터베이스 행 간의 식별자를 유지 관리하기 위해 데이터베이스 ID 필드를 저장하는 객체

### 작동 원리
* 데이터베이스의 어떤 종류의 키를 선택하는지 고려해야 하는데, 의미 있는 키와 의미 없는 키 중 어떤 것을 선택해야 한다.
  * 의미 있는 키는 비즈니스 상에서 사용될 수 있는 유의미한 값을 말한다.
  * 의미 없는 키는 비즈니스와 무관하게 생성한 임의의 키를 말한다.
  * 대체적으로는 의미 없는 키를 사용하는 것이 좋다.
* 단순 키와 복합 키 중 어떤 것을 사용할지 선택해야 한다.
  * 단순 키는 데이터베이스 필드 하나만 사용하지만 복합 키는 필드를 두 개 이상 사용한다.
* 키의 형식도 선택해야 한다.
  * 키를 사용하는 일반적인 연산은 동등 검사이므로 동등 연산이 빠른 형식을 선택하는 것이 좋다.
  * 다음으로 중요한 연산은 다음 키를 얻는 것이다. 따라서 크기 비교가 가능한(long과 같은) 키를 선택하는 것이 좋다.
* 키의 크기는 성능에 영향을 줄 수 있으며, 특히 인덱스를 사용할 때는 더 많은 영향을 준다.
* 식별자 필드는 데이터베이스의 키와 형식이 일치하는 필드로 만들면 간단하다.
* 복합 키의 경우에는 키 클래스를 만들어 사용한다.
  * 키 객체는 동등 비교가 되도록 유의해야 한다.
* 객체를 생성하려면 새로운 키가 필요한데, 데이터베이스에서 지원하는 자동 생성 방법이 일반적이고 간단하다.
  * 하지만 자동 생성되는 키의 값을 알아내기 어렵다는 문제가 있다.
* 자동 생성의 대안으로 오라클이 시퀀스와 함께 사용하는 데이터베이스 카운터가 있다.
  * 이는 데이터베이스의 표준은 아니며 일부 데이터베이스에서만 지원하므로 사용하기 전에 스펙을 잘 체크해야 한다.
* GUID는 컴퓨터에서 생성되는 숫자이며, 현존하는 모든 컴퓨터에서 고유성이 보장된다.
  * 하지만 키 문자열이 길다는 단점이 있다.

### 사용 시점
* 식별자 필드는 인메모리 객체와 데이터베이스 행 간의 매핑이 있을 때 사용한다. 일반적으로는 도메인 모델이나 행 데이터 게이트웨이를 사용하는 경우에 해당한다.
* 트랜잭션 스크립트나 테이블 모듈, 데이블 데이터 게이트웨이를 사용할 때는 이 매핑이 필요 없다.